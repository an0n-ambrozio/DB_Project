{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/an0n-ambrozio/Documents/an0n-ambrozio/database-design/DB_Project/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as {\n    prisma: PrismaClient | undefined\n}\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///Users/an0n-ambrozio/Documents/an0n-ambrozio/database-design/DB_Project/app/api/candidates/%5Bid%5D/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\n\nexport async function GET(request: Request, context: { params: Promise<{ id: string }> }) {\n    try {\n        const { id } = await context.params;\n        const candidateId = parseInt(id);\n        const candidate = await prisma.candidate.findUnique({\n            where: { id: candidateId },\n            include: { skills: true, interviews: true }\n        });\n\n        if (!candidate) return NextResponse.json({ error: 'Not found' }, { status: 404 });\n\n        return NextResponse.json(candidate);\n    } catch (error) {\n        return NextResponse.json({ error: 'Internal Error' }, { status: 500 });\n    }\n}\n\nexport async function PUT(request: Request, context: { params: Promise<{ id: string }> }) {\n    try {\n        const { id } = await context.params;\n        const candidateId = parseInt(id);\n        const body = await request.json();\n        const { name, email, phone, role, status, score, skills, experience, scoreBreakdown, photoUrl } = body;\n\n        // Transaction to handle updates and side effects (like creating Rejected/Connected records)\n        const updatedCandidate = await prisma.$transaction(async (tx) => {\n\n            // Handle Rejected Side Effects\n            if (status === 'rejected') {\n                await tx.rejectedCandidate.upsert({\n                    where: { candidateId },\n                    create: { candidateId },\n                    update: {}\n                });\n            } else if (status !== undefined) {\n                // If status is updated and NOT rejected, ensure it's removed from rejected list\n                await tx.rejectedCandidate.deleteMany({ where: { candidateId } });\n            }\n\n            // Handle Scheduled Side Effects\n            if (status !== undefined && status !== 'scheduled') {\n                // If status is updated and NOT scheduled, ensure it's removed from connected list\n                await tx.connectedCandidate.deleteMany({ where: { candidateId } });\n            }\n\n            // Prepare update data dynamicially to allow partial updates\n            const updateData: any = {};\n            if (name !== undefined) updateData.name = name;\n            if (email !== undefined) updateData.email = email;\n            if (phone !== undefined) updateData.phone = phone;\n            if (role !== undefined) updateData.role = role;\n            if (status !== undefined) updateData.status = status;\n            if (score !== undefined) updateData.score = parseFloat(score);\n            if (experience !== undefined) updateData.experience = experience;\n            if (scoreBreakdown !== undefined) updateData.scoreBreakdown = scoreBreakdown;\n            if (photoUrl !== undefined) updateData.photoUrl = photoUrl;\n\n            // Update standard candidate fields\n            const c = await tx.candidate.update({\n                where: { id: candidateId },\n                data: updateData\n            });\n\n            // Update skills if provided\n            if (skills) {\n                await tx.candidateSkill.deleteMany({ where: { candidateId } });\n                if (Array.isArray(skills) && skills.length > 0) {\n                    await tx.candidateSkill.createMany({\n                        data: skills.map((s: string) => ({ candidateId, skillName: s }))\n                    });\n                }\n            }\n\n            return c;\n        });\n\n        return NextResponse.json(updatedCandidate);\n    } catch (error) {\n        console.error('Update Error:', error);\n        return NextResponse.json({ error: 'Failed to update' }, { status: 500 });\n    }\n}\n\nexport async function DELETE(request: Request, context: { params: Promise<{ id: string }> }) {\n    try {\n        const { id } = await context.params;\n\n        // Prisma handles Cascade delete for Skills/Interviews automatically via schema\n        // But logs are SetNull.\n\n        await prisma.candidate.delete({\n            where: { id: parseInt(id) }\n        });\n\n        return NextResponse.json({ message: 'Deleted successfully' });\n    } catch (error) {\n        console.error('Delete Error:', error);\n        return NextResponse.json({ error: 'Failed to delete' }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":"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"}}]
}